# Диагонализация цепочки Гейзенберга по Ланцошу с использованием сохранения намагниченности и состояний полуимпульса с четностью и симметрией инверсии спина

## Исходный код
hchain_lanc.f90
dstev.f (процедура диагонализации LAPAC; вещественная симметричная трехдиагональная матрица)
random.f90 (генератор случайных чисел)

## Инструкции по запуску и примеры результатов

Диагонализация цепочки Гейзенберга по Ланцошу с использованием сохранения намагниченности и состояний полуимпульса с четностью и симметрией инверсии спина

Программа: hchan_lanc

Программа работает в секторе намагниченности mz = 0, но ее очень легко модифицировать для любого mz. Программа дает только энергию.

Инструкции по запуску
Вход:

Файл read.in, содержащий:
N, k, p, z
mlanc, rm, hm, vm

Строка 1, столбец 1: размер системы N (целое число)
Строка 1, столбец 2: индекс момента k (целое число, 0, ..., N / 2)
Строка 1, столбец 3: индекс четности p (целое число, + 1, - 1)
Строка 1, столбец 3: индекс инверсии спина z (целое число, + 1, -1)

Строка 2, столбец 1: количество итераций Ланцоша (целое число)
Строка 2, столбец 2: максимальное количество представителей
Строка 2, столбец 2: максимальное количество сохраненных H-элементов
Строка 2, столбец 3: максимальное количество различных H-элементов

Пример read.in

  16 0 1 1
  50 1000 10000 200  
Файл seed.in , содержащий целое случайное число seed
Пример read.in

  72637361
Выход:

Файл log.txt Информация об основании и требованиях к хранилищу (фактическое и максимальное значения).
Строка 1: Фактический и максимальный базовый размер
Строка 2: Фактическое и максимальное количество H-элементов
Строка 3: Фактическое и максимальное количество различных H-элементов

Файл itr.dat Схождение 5 низших энергий. Столбец 1: номер итерации (количество состояний Ланцоша)
Столбцы 2-6: пять наименьших собственных значений

Файл e.dat Все собственные значения последнего трехдиагонального гамильтониана Столбец 1: номер итерации
Столбец 2: энергия

Примеры и комментарии
Обратите внимание, что количество итераций (состояний) Ланцоша не может превышать фактическое количество состояний в рассматриваемом блоке, потому что это максимальное количество ортогональных состояний, которые могут быть сформированы. В качестве примера поведения программы при нарушении этого правила следующий вывод в itr.dat для N = 8 в секторе k = 0, p = 1, z = 1:

    2 -3,1621336950 -0,2736354218 0,0000000000 0,0000000000 0,0000000000
    3 -3,5964463541 -0,4960740597 0,5164881650 0,0000000000 0,0000000000
    4 -3,6410241885 -1,0594470880 -0,2525265803 1,2489598038 0,0000000000
    5 -3,6510005330 -1,7872019538 -0,4398498336 0,4218475976 1,9347353460
    6 -3,6510929337 -1,8016145828 -0,4460035910 0,3737378380 1,2145807857
    7 -3,6510934089 -1,8019377358 -0,7261094450 -0,4450418679 0,3772028540
    8 NaN NaN NaN NaN NaN
    9 NaN NaN NaN NaN NaN
Число блоков в состоянии равно 7, и энергии, полученные с помощью 7 итераций Ланцоша, являются точными. Продолжение после 7 итераций приводит к появлению мусора.